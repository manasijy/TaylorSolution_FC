
% function [x,fval,exitflag,output] = TaylorLinearProg(gvector,e_ext)

%  TaylorLinearProg([0,0,0],[1,0,0;0,-.5,0;0,0,-0.5])

% x(i) is shear
% x = ['g1','g2','g3','g4','g5','g6','g7','g8','g9','g10','g11', ...
%     'g12','g13','g14','g15','g16','g17','g18','g19','g20','g21',...
%     'g22','g23','g24'];    
tic
gvector = [10,20,0];
e_ext =[1,0,0;0,0,0;0,0,-1];

f = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];

DCMtrx = DC_matrix_function(gvector(1),gvector(2),gvector(3));
[e_grain]= transform_e_function(e_ext,DCMtrx);
beq = [e_grain(1,1);e_grain(2,2);2*e_grain(2,3);2*e_grain(1,3);2*e_grain(1,2)]; 

load('SlipSystem24.mat','SlipSystem'); 
Aeq = [[SlipSystem(1).m.M(1,1) , SlipSystem(2).m.M(1,1) , SlipSystem(3).m.M(1,1)...
     , SlipSystem(4).m.M(1,1),SlipSystem(5).m.M(1,1),SlipSystem(6).m.M(1,1)...
     ,SlipSystem(7).m.M(1,1),SlipSystem(8).m.M(1,1),SlipSystem(9).m.M(1,1)...
     ,SlipSystem(10).m.M(1,1),SlipSystem(11).m.M(1,1),SlipSystem(12).m.M(1,1)...
     ,SlipSystem(13).m.M(1,1) , SlipSystem(14).m.M(1,1) , SlipSystem(15).m.M(1,1)...
     , SlipSystem(16).m.M(1,1),SlipSystem(17).m.M(1,1),SlipSystem(18).m.M(1,1)...
     ,SlipSystem(19).m.M(1,1),SlipSystem(20).m.M(1,1),SlipSystem(21).m.M(1,1)...
     ,SlipSystem(22).m.M(1,1),SlipSystem(23).m.M(1,1),SlipSystem(24).m.M(1,1);
 SlipSystem(1).m.M(2,2) , SlipSystem(2).m.M(2,2) , SlipSystem(3).m.M(2,2)...
     , SlipSystem(4).m.M(2,2),SlipSystem(5).m.M(2,2),SlipSystem(6).m.M(2,2)...
     ,SlipSystem(7).m.M(2,2),SlipSystem(8).m.M(2,2),SlipSystem(9).m.M(2,2)...
     ,SlipSystem(10).m.M(2,2),SlipSystem(11).m.M(2,2),SlipSystem(12).m.M(2,2)...
     SlipSystem(13).m.M(2,2) , SlipSystem(14).m.M(2,2) , SlipSystem(15).m.M(2,2)...
     , SlipSystem(16).m.M(2,2),SlipSystem(17).m.M(2,2),SlipSystem(18).m.M(2,2)...
     ,SlipSystem(19).m.M(2,2),SlipSystem(20).m.M(2,2),SlipSystem(21).m.M(2,2)...
     ,SlipSystem(22).m.M(2,2),SlipSystem(23).m.M(2,2),SlipSystem(24).m.M(2,2)];
%  SlipSystem(1).m.M(3,3) , SlipSystem(2).m.M(3,3) , SlipSystem(3).m.M(3,3)...
%      , SlipSystem(4).m.M(3,3),SlipSystem(5).m.M(3,3),SlipSystem(6).m.M(3,3)...
%      ,SlipSystem(7).m.M(3,3),SlipSystem(8).m.M(3,3),SlipSystem(9).m.M(3,3)...
%      ,SlipSystem(10).m.M(3,3),SlipSystem(11).m.M(3,3),SlipSystem(12).m.M(3,3)...
%      ,SlipSystem(13).m.M(3,3) , SlipSystem(14).m.M(3,3) , SlipSystem(15).m.M(3,3)...
%      , SlipSystem(16).m.M(3,3),SlipSystem(17).m.M(3,3),SlipSystem(18).m.M(3,3)...
%      ,SlipSystem(19).m.M(3,3),SlipSystem(20).m.M(3,3),SlipSystem(21).m.M(3,3)...
%      ,SlipSystem(22).m.M(3,3),SlipSystem(23).m.M(3,3),SlipSystem(24).m.M(3,3);
 2*[SlipSystem(1).m.M(2,3) , SlipSystem(2).m.M(2,3) , SlipSystem(3).m.M(2,3)...
     , SlipSystem(4).m.M(2,3),SlipSystem(5).m.M(2,3),SlipSystem(6).m.M(2,3)...
     ,SlipSystem(7).m.M(2,3),SlipSystem(8).m.M(2,3),SlipSystem(9).m.M(2,3)...
     ,SlipSystem(10).m.M(2,3),SlipSystem(11).m.M(2,3),SlipSystem(12).m.M(2,3)...
     ,SlipSystem(13).m.M(2,3) , SlipSystem(14).m.M(2,3) , SlipSystem(15).m.M(2,3)...
     , SlipSystem(16).m.M(2,3),SlipSystem(17).m.M(2,3),SlipSystem(18).m.M(2,3)...
     ,SlipSystem(19).m.M(2,3),SlipSystem(20).m.M(2,3),SlipSystem(21).m.M(2,3)...
     ,SlipSystem(22).m.M(2,3),SlipSystem(23).m.M(2,3),SlipSystem(24).m.M(2,3);
SlipSystem(1).m.M(1,3) , SlipSystem(2).m.M(1,3) , SlipSystem(3).m.M(1,3)...
     , SlipSystem(4).m.M(1,3),SlipSystem(5).m.M(1,3),SlipSystem(6).m.M(1,3)...
     ,SlipSystem(7).m.M(1,3),SlipSystem(8).m.M(1,3),SlipSystem(9).m.M(1,3)...
     ,SlipSystem(10).m.M(1,3),SlipSystem(11).m.M(1,3),SlipSystem(12).m.M(1,3)...
     ,SlipSystem(13).m.M(1,3) , SlipSystem(14).m.M(1,3) , SlipSystem(15).m.M(1,3)...
     , SlipSystem(16).m.M(1,3),SlipSystem(17).m.M(1,3),SlipSystem(18).m.M(1,3)...
     ,SlipSystem(19).m.M(1,3),SlipSystem(20).m.M(1,3),SlipSystem(21).m.M(1,3)...
     ,SlipSystem(22).m.M(1,3),SlipSystem(23).m.M(1,3),SlipSystem(24).m.M(1,3);
SlipSystem(1).m.M(1,2) , SlipSystem(2).m.M(1,2) , SlipSystem(3).m.M(1,2)...
     , SlipSystem(4).m.M(1,2),SlipSystem(5).m.M(1,2),SlipSystem(6).m.M(1,2)...
     ,SlipSystem(7).m.M(1,2),SlipSystem(8).m.M(1,2),SlipSystem(9).m.M(1,2)...
     ,SlipSystem(10).m.M(1,2),SlipSystem(11).m.M(1,2),SlipSystem(12).m.M(1,2)...
     ,SlipSystem(13).m.M(1,2) , SlipSystem(14).m.M(1,2) , SlipSystem(15).m.M(1,2)...
     , SlipSystem(16).m.M(1,2),SlipSystem(17).m.M(1,2),SlipSystem(18).m.M(1,2)...
     ,SlipSystem(19).m.M(1,2),SlipSystem(20).m.M(1,2),SlipSystem(21).m.M(1,2)...
     ,SlipSystem(22).m.M(1,2),SlipSystem(23).m.M(1,2),SlipSystem(24).m.M(1,2);... 
    ]];


options = optimoptions(@linprog,'Algorithm','simplex');

lb = zeros(1,24);
ub = 10*( ones(1,24));
toc
tic
[x,fval,exitflag,output] = linprog(f,[],[],Aeq,beq,lb,ub,[],options);
toc
tic
[xWeb1,fWeb1,itnWeb1] = linprogWEB1(Aeq,beq,f);
toc
% end
% options = optimoptions(@linprog,'Algorithm','interior-point');
% options = optimoptions(@linprog,'Algorithm','active-set');
% [x,fval,exitflag,output] = linprog(f,[],[],Aeq,beq);
%x = linprog(f,A,b,Aeq,beq,lb,ub,x0,options)

